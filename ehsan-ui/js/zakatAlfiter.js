import{P as e}from"./redirectToPayment.js";import{T as t}from"./tom-select.complete.js";import"./bootstrap.js";const n=new e,r=document.getElementById("regionId");let a=0,o=0,i=30,l=0,d=document.getElementById("persons"),s=document.getElementById("zakatAmount"),c=document.querySelectorAll(".hanldeNumberOfMembers");const u=document.getElementById("btnPayZakatAlfiter"),m=document.getElementById("zakatAlFiterErrorNumberOfMembers"),f=document.getElementById("ZakatAlFiterId");let p=document.getElementById("regionId").value;const h=f.value;let g;r&&(g=new t("#regionId",{render:{option:function(e,t){var n=""!==e.closed;return'<div class="custom-option-regions">'+t(e.text)+(n?'<span class="closed">أغلقت</span>':"")+"</div>"},option_create:function(e,t){return'<div class="custom-option-regions">'+t(e.input)+"</div>"}},create:!1,maxItems:1,closeAfterSelect:!0,placeholder:"أختر منطقة"}));let b=function(e){fetch("/ZakatAlFiter/"+h+"/Organization/"+e,{method:"POST",headers:{"Content-type":"application/json"}}).then((function(e){return e.json()})).then((function(e){null!=e?(l=e.id,a=e.zakatPerPerson,i=e.remainingBeneficiaries>30?30:e.remainingBeneficiaries):g.clear()})).catch((function(e){}))};b(p),null==r||r.addEventListener("change",(function(){p=isNaN(this.value)?0:this.value;document.getElementById("zakatAlFiterErrorContainer").innerHTML="",d.value=0,o=0,a=0,s.innerText=0,""!=p&&"0"!=p?(u.disabled=!1,b(p)):u.disabled=!0})),c.forEach((e=>{e.addEventListener("click",(function(){let t=e.dataset.increase;"true"==t?o<i&&o++:o>0&&o--,o>0?(m.textContent="",u.disabled=!1):m.textContent="يرجى تحديد عدد الأفراد.",d.value=o,document.getElementById("sr-people-total").innerText="عدد الأفراد: "+o,s.innerText=o*a,null==u||u.setAttribute("aria-label",`أخرِج زكاة الفطر الآن. الإجمالي: ${o*a} ريال سعودي`)}))})),null==u||u.addEventListener("click",(function(e){let t=this;if(t.disabled=!0,e.preventDefault(),o<=0||""==p||"0"==p)return""!=p&&"0"!=p||(zakatAlFiterErrorContainer.textContent="يرجى تحديد منطقة توزيع الزكاة"),o<=0&&(m.textContent="يرجى تحديد عدد الأفراد."),t.disabled=!1,!1;fetch("ZakatAlFiter/"+l+"/Pay/"+o,{method:"POST",headers:{"Content-Type":"application/json"}}).then((e=>{if(!e.ok)throw t.disabled=!1,new Error("حدث خطأ في عملية الدفع");return e.json()})).then((e=>{e.isSuccess?(n.redirectToPayment(!0),window.location.href=e.baseUri+"Payment?transactionId="+e.result):t.disabled=!1})).catch((e=>{t.disabled=!1}))}));
//# sourceMappingURL=zakatAlfiter.js.map
